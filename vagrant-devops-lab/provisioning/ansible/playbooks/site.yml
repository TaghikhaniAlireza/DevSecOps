---
- name: Preflight checks
  hosts: all
  gather_facts: true
  roles:
    - role: preflight
      tags:
        - preflight
        - safety

- name: Base system configuration
  hosts: all
  become: true
  roles:
    - role: system_hardening
      tags:
        - system

- name: Nginx baseline setup
  hosts: app
  become: true
  roles:
    - role: nginx_hardening
      tags:
        - nginx

- name: PostgreSQL baseline setup
  hosts: db
  become: true
  roles:
    - role: postgresql_baseline
      tags:
        - postgresql